---
title: Dynamic Bonding Curve Formula
---

The Dynamic Bonding Curve is a flexible bonding curve that allows you to configure up to 16 curve segments to control the curve's shape and price action. Each curve segment follows a constant product formula:

<div align="center">
$$x \times y = k$$
</div>

## Mathematical Foundation

A simple constant product formula can be expressed as:

<div align="center">
$$x \times y = \text\{VirtualBaseReserve\} \times \text\{VirtualCurveReserve\}$$
</div>

This can also be represented as:

<div align="center">
$$x \times y = \text{Liquidity}^2$$
</div>

Where:
<div align="center">
$$\text\{Liquidity\} = \sqrt\{\text\{VirtualBaseReserve\} \times \text\{VirtualCurveReserve\}\}$$
</div>

With a constraint on `migration_quote_threshold`, this can be presented as a function of liquidity, minimum price, and maximum price. We denote:
- `l` = liquidity
- `pa` = minimum price  
- `pb` = maximum price

Therefore:
<div align="center">
$$\text\{BondingCurveConstantProduct\} = f(l, pa, pb)$$
</div>

## Dynamic Bonding Curve Protocol

In our dynamic bonding curve protocol:
<div align="center">
$$\text\{BondingCurve\} = f([l_i, pa_i, pb_i])$$
</div>

This means partners can configure a bonding curve with any liquidity distribution based on their strategy.

## Example Configuration

Consider a pool with the following configuration:

```
sqrt_start_price = 1
curve = [
  (sqrt_price = 2, liquidity = 100),
  (sqrt_price = 4, liquidity = 500)
]
```

<Note>These are just example values and are not real values. You will have to calculate in actual `sqrt_price` and `liquidity` values which will be much bigger.</Note>

The bonding curve will function across 2 price ranges:

- **Range 1**: `(l = 100, pa = 1, pb = 2)`
- **Range 2**: `(l = 500, pa = 2, pb = 4)`

# Core Formulas

Below are the core formulas used in the dynamic bonding curve protocol. We use the following notation:

- Let $L_i$ = liquidity in range $i$
- Let $P_i$ = price at boundary $i$
- $P_{i-1}$ = price at the lower boundary of range $i$

---

### 1. Bonding Curve Swap Amount

The total swap amount across all price ranges is given by:

<div align="center">

$$
\text{Swap Amount} = \sum_{i} L_i \left( \frac{1}{P_{i-1}} - \frac{1}{P_i} \right)
$$

</div>

---

### 2. Migration Quote Threshold

The migration quote threshold is calculated as:

<div align="center">

$$
\text{Migration Quote Threshold} = \sum_{i} L_i (P_i - P_{i-1})
$$

</div>

---

### 3. Migration Price Calculation

To determine the migration price squared ($p_\text{max}^2$) during migration, use:

<div align="center">

$$
p_\text{max}^2 = \frac{\text{Migration Quote Threshold} \times (1 - \text{migrationFeePercentage})}{\text{Migration Amount}}
$$

</div>

Where:
- $\text{migrationFeePercentage}$ is the fee (as a decimal, e.g., 0.01 for 1%)
- $\text{Migration Amount}$ is the total amount being migrated

---

These formulas allow you to compute swap amounts, migration thresholds, and price limits for any custom liquidity distribution along the bonding curve.
